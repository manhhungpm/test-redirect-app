<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>App Redirection</title>
</head>
<body>


  <iframe style="display:none" height="0" width="0" id="loader"></iframe>

  <script>
    function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    (function(){

    //1
    // var fallbackLink = 'http://example.com/my-web-app/'+window.location.search+window.location.hash;
    // var isiOS = navigator.userAgent.match('iPad') || navigator.userAgent.match('iPhone') || navigator.userAgent.match('iPod'),
    //     isAndroid = navigator.userAgent.match('Android');
    // if (isiOS || isAndroid) {
    //   //document.getElementById('loader').src = 'com.vpbank.myvpbank://com.vpbank.myvpbank'+window.location.search+window.location.hash;
    //   document.getElementById('loader').src = 'com.vpbank.myvpbank://';
    //   fallbackLink = isAndroid ? 'https://play.google.com/store/apps/details?id=com.vpbank.myvpbank&hl=vi&gl=US' :
    //                              'itms-apps://itunes.apple.com/app/myvpbank/id1661762590' ;
    // }
    // window.setTimeout(function (){ window.location.replace(fallbackLink); }, 1);
    //--


    //2
    // setTimeout(function () { window.location = "itms-apps://itunes.apple.com/app/myvpbank/id1661762590"; }, 25);
    // window.location = "com.vpbank.myvpbank://";
    //--


    //3
    var fallbackLink = getParameterByName('redirect_url') ? getParameterByName('redirect_url') : 'http://example.com/my-web-app/';
    var customProtocol = getParameterByName('custom_protocol');
    var androidStore = getParameterByName('android_store');
    var iosStore = getParameterByName('ios_store');

    var isiOS = navigator.userAgent.match('iPad') || navigator.userAgent.match('iPhone') || navigator.userAgent.match('iPod');
    var isAndroid = navigator.userAgent.match('Android');

    if(isiOS) {
      setTimeout(function () { window.location = "itms-apps://itunes.apple.com/app/myvpbank/id1661762590"; }, 25);
      window.location = "myvpbank://myvpbank";
    } else if (isAndroid) {
      setTimeout(function () { window.location = "https://play.google.com/store/apps/details?id=com.vpbank.myvpbank&hl=vi&gl=US"; }, 1000);
      window.location = "myvpbank://myvpbank";
    } else {
      window.setTimeout(function (){ window.location.replace('http://example.com/my-web-app/'); }, 1);
    }

    })();
  </script>
</body>
</html>
