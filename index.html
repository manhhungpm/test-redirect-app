<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>App Redirection</title>

  <script>
    function getParameterByName(name, url) {
      if (!url) url = window.location.href;
      name = name.replace(/[\[\]]/g, "\\$&");
      var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    }


    //Get param from long link
    var fallbackLink = getParameterByName('redirect_url') ? getParameterByName('redirect_url') : 'http://example.com/my-web-app/';
    var customProtocol = getParameterByName('custom_protocol');
    var androidStore = getParameterByName('android_store');
    var iosStore = getParameterByName('ios_store');


    function isApple() {
      // var isiOS = navigator.userAgent.match('iPad') || navigator.userAgent.match('iPhone') || navigator.userAgent.match('iPod');
	    return navigator.userAgent.indexOf('iPhone') > 0 || navigator.userAgent.indexOf('iPad') > 0;
    }

    function isAndroid() {
      // var isAndroid = navigator.userAgent.match('Android');
	    return navigator.userAgent.indexOf('Android') > 0;
    }

    function isBrowser() {
      var ua = navigator.userAgent;
      if (isApple()) {
        return ua.indexOf('Safari/') > 0;
      }
      return ua.indexOf('Chrome/') > 0 && ua.indexOf('Chrome/30.0') < 0;
    }

    function isPageHidden() {
      return document["hidden"] || document["mozHidden"] || document["webkitHidden"] || document["msHidden"];
    }


    function autoOpen(){
      if(isApple){
        var userActionTimeout = 3000;
        var autoActionTimeout = 5000;
      }
    }

    
  </script>
</head>
<body>

  <iframe style="display:none" height="0" width="0" id="loader"></iframe>
  <script>

    
    if(isApple) {
      setTimeout(function () { window.location = "itms-apps://itunes.apple.com/app/myvpbank/id1661762590"; }, 25);
      window.location = "myvpbank://myvpbank";
    } else if (isAndroid) {


      window.location = "myvpbank://myvpbank";

      
      var timeOutAndroid = setTimeout(function () { 
        // if(!document.hidden || !document.webkitHidden){
          window.location = "https://play.google.com/store/apps/details?id=com.vpbank.myvpbank&hl=vi&gl=US"; 
        // }
      }, 2000);

      
      //clearTimeout(timeOutAndroid)

    } else {
      window.setTimeout(function (){ window.location.replace('http://example.com/my-web-app/'); }, 1);
    }

  </script>
</body>
</html>
